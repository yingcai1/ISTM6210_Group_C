{% extends 'base.html' %}
{% block title %}
Victim Page

{% endblock %}

{% block content %}
<style>
    .form-control{
        padding: 0.2rem .75rem;
    }
    .row {
        margin-right: 15px;
        margin-left: 15px;
    }
    .alert-primary{
        width: 50%;
        margin: auto;
        background-color: #afe6f7;
        border-color: #09d2ff;
        color: green;
    }
    .register-title{
    text-align: center;
    margin-top: 1%;
    color: black;
    /* color: #495057; */
}
    .register{
    /* background: -webkit-linear-gradient(left, #af8e31, #00ff37); */
    /* background: -webkit-linear-gradient(-150deg, #0270ff 10%, rgba(0, 0, 0, 0) 70%), url('https://www.plm.automation.siemens.com/media/global/en/Artificial-Intelligence-AI-Automotive-AT_tcm27-91268.jpg');
    background: -o-linear-gradient(-150deg, #0270ff 10%, rgba(0, 0, 0, 0) 70%), url('https://www.plm.automation.siemens.com/media/global/en/Artificial-Intelligence-AI-Automotive-AT_tcm27-91268.jpg');
    background: -moz-linear-gradient(-150deg, #0270ff 10%, rgba(0, 0, 0, 0) 70%), url('https://www.plm.automation.siemens.com/media/global/en/Artificial-Intelligence-AI-Automotive-AT_tcm27-91268.jpg'); */
    background: linear-gradient(-150deg, #0270ff 10%, rgba(0, 0, 0, 0) 70%), url('https://www.plm.automation.siemens.com/media/global/en/Artificial-Intelligence-AI-Automotive-AT_tcm27-91268.jpg');
    background-size: cover;
    margin-top: 3%;
    padding: 3%;
    border-top-left-radius: 20% 50%;
    border-bottom-left-radius: 20% 50%;
    border-top-right-radius: 20% 50%;
    border-bottom-right-radius: 20% 50%;
}
.register .register-form{
    padding: 2%;
    margin-top: 1%;
}
.btnRegister{
    border-radius: 2rem;
    padding: 1.5%;
    color: #fff;
    width: 50%;
    cursor: pointer;
}
#viewVictims {
    margin: auto;
    background-color: #0270ff;
    color: white;
    display: block;
    height: 40px;
    line-height: 40px;
    text-decoration: none;
    border-radius: 10px;
    width: 30%;
    text-align: center;
}
#victims {
  margin-top: 100%;
  padding-bottom: 5%;
  padding-top: 1%;
 } 
  html{
    scroll-behavior: smooth;

    color: white;
  }
  body {
  margin: 0;
  padding: 0;
  color: white;
}
label {
  color: white;
}
select{
  color: white;
}
table.dataTable tbody tr {
  background-color: #343a40;
}
.dataTables_wrapper .dataTables_filter input {
background-color: white;
}
.dataTables_wrapper .dataTables_info {
  color: white;
}
.table-hover tbody tr:hover td, .table-hover tbody tr:hover th {
  background-color: black;
}
.dataTables_wrapper .dataTables_paginate .paginate_button {
  color: white !important;
  border-radius: 5px;
  margin:2px;
  border: 1px solid #008bff;
}
.dataTables_wrapper .dataTables_paginate .paginate_button:hover{
  background-color: #008bff;
  border: 1px solid red;
}
.btn-group>.btn-group:not(:last-child)>.btn, .btn-group>.btn:not(:last-child):not(.dropdown-toggle) {
  border-radius: 5px;
  margin-right: 5px;
}
.btn-group>.btn-group:not(:first-child)>.btn, .btn-group>.btn:not(:first-child) {
  border-radius: 5px;
  margin-left: 5px;
}
.modal-Background {
  background-image: url("https://images.all-free-download.com/images/graphicthumb/abstract_background_310618.jpg");
  background-repeat: no-repeat;
  background-size: cover;
  background-size: 100% 100%;
}
.scrollToTopBtn {
  background-color: #0270ff;
  color: #0270ff;
  transform: translateY(100px);
  position: fixed;
  font-size: 18px;
  line-height: 50px;
  width: 50px;
  bottom: 50px;
  right: 30px;
  border-radius: 50%;
  border: none;
  opacity: 0;
  transition: all 0.5s ease;
  z-index: 50;
}

.showBtn {
  opacity: 1;
  transform: translateY(0);
}
</style>
<body class="text-center">
        <form method="POST" class="form-register" style="color:white" enctype="multipart/form-data">
            {{ form.hidden_tag() }}
            <br>
            <img class="mb-3" width="80" height="80" src="https://kevinekline.com/wp-content/uploads/2014/06/EmergencyAlerts_5.png" alt="">
            <a id="viewVictims" href="#victims">View All Victims</a>

            <div class="container register">
                <div class="col-md-12">
                <p style="color: white; text-decoration: solid; text-decoration-line: underline;" class="h3 mb-3 font-weight-normal register-title">
                    Add New Victim Information
                </p>
            </div>
            <div class="col-md-12">
              <section style="width: 50%; margin: auto;">
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category,message in messages %}
                        <div class="alert alert-{{category}} alert-dismissible fade show" role="alert">
                            <span>{{ message }}</span>
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}
                </section>
            </div>

        <div class="row register-form">
            <div class="col-md-6">
                {{ form.user_firstname.label() }}
                {{ form.user_firstname(class="form-control",style="background-color:#eee", placeholder="First Name...") }}
            </div>
            <div class="col-md-6">
                {{ form.user_lastname.label() }}
                {{ form.user_lastname(class="form-control",style="background-color:#eee", placeholder="Last Name...") }}
            </div>
            <div class="col-md-6">
              {{ form.phone.label() }}
              {{ form.phone(class="form-control",style="background-color:#eee", placeholder="Phone Number...") }}
          </div>
          <div class="col-md-6">
            {{ form.email_address.label() }}
            {{ form.email_address(class="form-control",style="background-color:#eee", placeholder="Email Address...") }}
          </div>
            <div class="col-md-6">
              {{ form.photo.label() }}
              {{ form.photo(class="form-control",style="background-color:#eee") }}
            </div>
        </div>
            <br>
            <div class="col-md-12">
              {{ form.submit(class="btn btn-lg btn-primary btnRegister") }}

              <!-- <input type="submit" name="btnEdit" class="btn btn-success" value="Add Victim"> -->
            </div>
        </div>
        </form>
    
<br>
<div id="victims" class="table-responsive" style="text-align: center; color: white; width: 90%; margin: auto;">
    <table id="myTable" class="datatable table table-hover table-dark table-striped table-bordered">
        <thead style="color: rgba(51, 255, 0, 0.8);">
            <tr>
                <!-- Columns -->
                <th scope="col">Victim ID</th>
                <th scope="col"><i class="fa fa-user" aria-hidden="true" style="margin-right: 5px;"></i>First Name</th>
                <th scope="col"><i class="fa fa-user" aria-hidden="true" style="margin-right: 5px;"></i>Last Name</th>
                <th scope="col"><i class="fa fa-phone" style="margin-right: 5px;" aria-hidden="true"></i>Phone</th>
                <th scope="col"><i class="fa fa-envelope" aria-hidden="true" style="margin-right: 5px;"></i>Email</th>
                <th scope="col"><i class="fa fa-image" aria-hidden="true" style="margin-right: 5px;"></i>Photo</th>
                <th><i class="fa fa-tasks" aria-hidden="true" style="margin-right: 5px;"></i>Action</th>
                
            </tr>
        </thead>
        <tbody>
            {% for victim in victims %}
                <tr>
                    <td>{{victim.ID}}</td>
                    <td>{{ victim.FirstName }}</td>
                    <td>{{ victim.LastName }}</td>
                    <td>{{victim.Phone}}</td>
                    <input type="text" style="display: none;" name="ID" value="{{victim.ID}}">

                    </td>
                      <td>{{ victim.Email}}</td>
                      <td><img width="200" height="200" class="img-fluid img-thumbnail" src="data:image/jpeg;base64,{{victim.Photo}}" alt="b"></td>
                      <td>
                        <input type="hidden" name="ID" value="{{victim.ID}}">
                        <!-- <a href="/victims/{{victim.ID}}" class="btn btn-success"></a> -->
                        <!-- <button class="btn btn-outline btn-success">View</button> -->
                        <a href="/victims/{{victim.ID}}" class="btn btn-success" data-toggle="modal" data-target="#myModal{{victim.ID}}"><i class="fas fa-edit"></i></a>

                    </td>
                </tr>
                <!-- update information model -->
                <div id="myModal{{victim.ID}}" class="modal fade" role="dialog">
                  <div class="modal-dialog">
                      <div class="modal-content modal-Background">
                          <div class="modal-header">
                            <h4 style="color: red;" class="modal-title" id="myModalLabel">Update User No.{{victim.ID}}</h4>
                              <button type="button" class="close" onClick="window.location.reload();" data-dismiss="modal" aria-hidden="true">&times;</button>
                          </div>
                          <div class="modal-body">
                            <form action="{{url_for('victim_page')}}" method="POST">
                              <div class="form-group">
                               <input type="hidden" name="ID" value="{{victim.ID}}">
                               <img width="200" height="200" class="img-fluid img-thumbnail" src="data:image/jpeg;base64,{{victim.Photo}}" alt="Victim image">
    
                              </div>
                              <!-- <div class="form-group">
                               <label style="color: black; font-weight: bold;">First Name:</label>
                               <input class="form-control" name="FirstName" value="{{victim.FirstName}}"></input>
                               </div>
                               <div class="form-group">
                                <label style="color: black; font-weight: bold;">Last Name:</label>
                                <input class="form-control" name="LastName" value="{{victim.LastName}}"></input>
                                </div> -->
                                <div class="form-group">
                                  <label style="color: black; font-weight: bold;">Phone:</label>
                                  <input class="form-control" name="Phone" value="{{victim.Phone}}"></input>
                                  </div>
                                  <div class="form-group">
                                    <label style="color: black; font-weight: bold;">Email:</label>
                                    <input class="form-control" name="Email" value="{{victim.Email}}"></input>
                                    </div>
                              <div class="form-group">
                               <input type="submit" id={{victim.ID}} name="btnDelete" class="btn btn-danger" value="Delete" 
                               style="text-transform: uppercase; margin-top: 15px;" onclick="return confirm('Are You Sure To Delete?')">
                               <input type="submit" id={{victim.ID}} name="btnEdit" class="btn btn-success" value="Edit" 
                                style="text-transform: uppercase; margin-top: 15px;" onclick="return confirm('Are You Sure To Make Changes?')">
                               <!-- <button class="btn btn-primary" type="submit">Update</button> -->
                              </div>
                             </form>
                          </div>
                          <!-- <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                          </div> -->
                      </div>
                  </div>
              </div>
      {% endfor %}
        </tbody>
    </table>
</div>
<button class="scrollToTopBtn">☝️</button>

</body>
{% endblock %}
{% block scripts %}

<script>
    var dataTable = $('.datatable').DataTable({
      "lengthMenu": [[5, 10, 25, -1], [5, 10, 25, "All"]],
      pagingType: 'full_numbers',
      responsive: true,
      columns: [
        {orderable: true, searchable: true},
        {orderable: true, searchable: true},
        {orderable: true, searchable: true},
        {orderable: true, searchable: true},
        {orderable: true, searchable: true},
        {orderable: false, searchable: false},
        {orderable: false, searchable: false}],

      order: [[0,'asc']],
      
      language: {
        "search": '<i class="fa fa-search"></i>',
        "searchPlaceholder": "Search...",
        paginate: {next: '<span class="pagination-default">Next </span><i class="fa fa-chevron-right">',
        previous: '<i class="fa fa-chevron-left"><span class="pagination-default"> Previous</span>'}
      },
      
      dom: "<'row'<'col-md-6'l><'col-md-6'f>>" +
            "<'row'<'col-md-12'tr>>" +
            "<'row'<'col-md-5'i><'col-md-7'p>>",
drawCallback: function(settings) {
  if (!$('.datatable').parent().hasClass('table-responsive')) {
    $('.datatable').wrap("<div class='table-responsive'></div>");
  }
}
});
</script>
<script>
var scrollToTopBtn = document.querySelector(".scrollToTopBtn");
var rootElement = document.documentElement;
function handleScroll() {
  var scrollTotal = rootElement.scrollHeight - rootElement.clientHeight;
  if (rootElement.scrollTop / scrollTotal > 0.7) {
    scrollToTopBtn.classList.add("showBtn");
  } else {
    scrollToTopBtn.classList.remove("showBtn");
  }
}

function scrollToTop() {
  rootElement.scrollTo({
    top: 0,
    behavior: "smooth"
  });
}
scrollToTopBtn.addEventListener("click", scrollToTop);
document.addEventListener("scroll", handleScroll);
</script>
{% endblock %}
